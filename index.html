<div id="result">Scanned details will appear here...</div>

<script>
  let html5QrCode;
  let scannedDetails = [];

  function startScanner() {
    document.getElementById("reader").style.display = "block";
    html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      (decodedText) => {
        try {
          let data = JSON.parse(decodedText);
          scannedDetails.push(data);
          localStorage.setItem("scannedData", JSON.stringify(scannedDetails));
          displayAllResults();
          html5QrCode.stop().then(() => {
            document.getElementById("reader").style.display = "none";
          });
        } catch (e) {
          alert("Invalid QR Code!");
        }
      }
    );
  }

  function displayAllResults() {
    const container = document.getElementById("result");
    container.innerHTML = "";
    scannedDetails.forEach((data, index) => {
      container.innerHTML += `
        <div style="margin-bottom:15px; text-align:left;">
          <strong>Scan ${index + 1}</strong><br>
          <b>Booking ID:</b> ${data.BookingID}<br>
          <b>Name:</b> ${data.Name}<br>
          <b>Contact:</b> ${data.Contact}<br>
          <b>Age:</b> ${data.Age}<br>
          <b>Gender:</b> ${data.Gender}<br>
          <b>Size:</b> ${data.Size}<br>
          <b>Paid:</b> ${data.Paid}<br>
          <b>Due:</b> ${data.Due}<br>
          <b>Total:</b> ${data.Total}<br>
          <b>Confirmation:</b> ${data.Confirmation}<br>
        </div>
      `;
    });
  }

  function resetDetails() {
    scannedDetails = [];
    localStorage.removeItem("scannedData");
    document.getElementById("result").innerText = "Scanned details will appear here...";
  }

  // Load saved details on page load
  window.onload = () => {
    let saved = localStorage.getItem("scannedData");
    if (saved) {
      scannedDetails = JSON.parse(saved);
      displayAllResults();
    }
  }
</script>
